<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:form id="newOrderForm">
        <p:growl id="msg" /> 
        <p:wizard backLabel="#{bundle.wizardBack}" nextLabel="#{bundle.wizardNext}" style="height: auto" >
            <p:tab title="#{bundle.newOrderTabFromTitle}" id="tabFrom">
                <h:panelGrid columns="4" style="height:auto">
                    <h:outputText value="#{bundle.newOrderTabFromName}" />  
                    <p:inputText id="from_Name" size="40" value="#{newOrderController.newOrderForm.from.name}" 
                                 required="true" requiredMessage="Il nome Mittente e' obbligatorio"/>
                    <p:watermark for="from_Name" value="Nome Mittente *" />
                    <p:message for="from_Name" />

                    <h:outputText value="Email:" />  
                    <p:inputText id="from_email" label="from_email" size="40"
                                 validatorMessage="Invalid email format"
                                 value="#{newOrderController.newOrderForm.from.email}">
                        <f:validateRegex
                            pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$|^$" />
                    </p:inputText>
                    <p:watermark for="from_email" value="Email Address *" />
                    <p:message for="from_email" />

                    <h:outputText value="#{bundle.newOrderTabFromStreet}" />
                    <p:inputText id="from_street" value="#{newOrderController.newOrderForm.from.street}"/>
                    <p:watermark for="from_street" value="Street Address *" />
                    <p:message for="from_street" />

                    <h:outputText value="#{bundle.newOrderTabFromNum}" />
                    <p:inputText id="from_number" value="#{newOrderController.newOrderForm.from.number}" 
                                 validatorMessage="Invalid number format">
                        <f:validateRegex pattern="^([1-9]*)$" />
                    </p:inputText>
                    <p:watermark for="from_number" value="Number Address *" />
                    <p:message for="from_number" />


                    <h:outputText value="#{bundle.newOrderTabFromCity}" />
                    <p:inputText id="from_city" value="#{newOrderController.newOrderForm.from.city}"
                                 required="true" requiredMessage="City is mandatory"/>
                    <p:watermark for="from_city" value="City *" />
                    <p:message for="from_city" />

                    <h:outputText value="#{bundle.newOrderTabFromProvince}" />
                    <p:inputText id="from_prov" value="#{newOrderController.newOrderForm.from.adminAreaLevel2}"/>
                    <p:watermark for="from_prov" value="Province *" />
                    <p:message for="from_prov" />

                    <h:outputText value="#{bundle.newOrderTabFromZip}" />
                    <p:inputText id="from_zip" value="#{newOrderController.newOrderForm.from.zipCode}" validatorMessage="Invalid zip format">
                        <f:validateRegex pattern="^([0-9]{5})$|^$"/>
                    </p:inputText>
                    <p:watermark for="from_zip" value="Zip code *" />
                    <p:message for="from_zip" />

                </h:panelGrid>
            </p:tab>
            <p:tab title="#{bundle.newOrderTabToTitle}" id="tabTO">
                <h:panelGrid columns="4" style="height:auto">
                    <h:outputText value="#{bundle.newOrderTabToName}" />  
                    <p:inputText id="to_Name" size="40" value="#{newOrderController.newOrderForm.to.name}" 
                                 required="true" requiredMessage="Il nome Destinatario e' obbligatorio"/>
                    <p:watermark for="to_Name" value="Nome Destinatario *" />
                    <p:message for="to_Name" />

                    <h:outputText value="Email:" />  
                    <p:inputText id="to_email" label="to_email" size="40"
                                 validatorMessage="Invalid email format"
                                 value="#{newOrderController.newOrderForm.to.email}">
                        <f:validateRegex
                            pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$|^$" />
                    </p:inputText>
                    <p:watermark for="to_email" value="Email Address *" />
                    <p:message for="to_email" />

                    <h:outputText value="#{bundle.newOrderTabFromStreet}" />
                    <p:inputText id="to_street" value="#{newOrderController.newOrderForm.to.street}"/>
                    <p:watermark for="to_street" value="Street Address *" />
                    <p:message for="to_street" />

                    <h:outputText value="#{bundle.newOrderTabFromNum}" />
                    <p:inputText id="to_number" value="#{newOrderController.newOrderForm.to.number}" 
                                 validatorMessage="Invalid number format">
                        <f:validateRegex pattern="^([1-9]*)$" />

                    </p:inputText>
                    <p:watermark for="to_number" value="Number Address *" />
                    <p:message for="to_number" />


                    <h:outputText value="#{bundle.newOrderTabFromCity}" />
                    <p:inputText id="to_city" value="#{newOrderController.newOrderForm.to.city}"
                                 required="true" requiredMessage="City is mandatory"/>
                    <p:watermark for="to_city" value="City *" />
                    <p:message for="to_city" />

                    <h:outputText value="#{bundle.newOrderTabFromProvince}" />
                    <p:inputText id="to_prov" value="#{newOrderController.newOrderForm.to.adminAreaLevel2}"/>
                    <p:watermark for="to_prov" value="Province *" />
                    <p:message for="to_prov" />

                    <h:outputText value="#{bundle.newOrderTabFromZip}" />
                    <p:inputText id="to_zip" value="#{newOrderController.newOrderForm.to.zipCode}" validatorMessage="Invalid zip format">
                        <f:validateRegex pattern="^([0-9]{5})$|^$"/>
                    </p:inputText>
                    <p:watermark for="to_zip" value="Zip code *" />
                    <p:message for="to_zip" />

                </h:panelGrid>
            </p:tab>
            <p:tab title="#{bundle.newOrderTabOrderTitle}" id="tabOrder">
                <h:panelGrid columns="2" style="vertical-align: text-top">
                    <h:outputText value="#{bundle.newOrderTabOrdineClientAccount}" />  
                    <p:inputText value="#{newOrderController.newOrderForm.clientAccountName}" required="true" 
                                 requiredMessage="Il nome del client account e' obbligatorio"/>
                    <h:outputText value="#{bundle.newOrderTabOrdineNote}" />
                    <p:inputText value="#{newOrderController.newOrderForm.note}"/>
                    <h:outputText value="#{bundle.newOrderTabOrdineTermini}" />
                </h:panelGrid>
                <p:panel header="Crea nuovo Termine di consegna">  
                    <h:panelGrid columns="2" id="grid"> 
                        <h:outputLabel value="Key : *" for="termIDkey"></h:outputLabel> 
                        <p:selectOneMenu id="termIDkey" value="#{newOrderController.currentTerm.key}" required="false">  
                            <f:selectItem itemLabel="Select a Key" itemValue="" />  
                            <f:selectItem itemLabel="Key1" itemValue="key1" />  
                            <f:selectItem itemLabel="Key2" itemValue="key2" />
                            <f:selectItem itemLabel="Key3" itemValue="key3" />
                        </p:selectOneMenu>       
                        <h:outputLabel value="Value : *" for="termIDval"></h:outputLabel>  
                        <p:inputText id="termIDval" required="false"   
                                     value="#{newOrderController.currentTerm.value}" />  

                        <p:commandButton value="Reset" type="reset"/>  
                        <p:commandButton id="btn_term_add" value="Add" update="TerminiDiConsegnaPanel"
                                         action="#{newOrderController.addTerm()}" >  
                            <p:collector unique="false" value="#{newOrderController.currentTerm}"   
                                         addTo="#{newOrderController.termList}" />  
                        </p:commandButton>  
                    </h:panelGrid>  
                </p:panel>  
                <p:outputPanel id="TerminiDiConsegnaPanel" autoUpdate="true">
                    <p:dataTable id="termTable" value="#{newOrderController.termList}" 
                                 var="term">
                        <p:column >
                            <f:facet name="header">#{bundle.newOrderTabOrdineTerminiKey}</f:facet>
                            <h:outputText value="#{term.key}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">#{bundle.newOrderTabOrdineTerminiValue}</f:facet>
                            <h:outputText value="#{term.value}"/>
                        </p:column>
                        <p:column>  
                            <f:facet name="header">  
                                <h:outputText value="Operation" />  
                            </f:facet>  
                            <p:commandButton value="Remove" update=":accordionP:newOrderForm:TerminiDiConsegnaPanel" 
                                             process=":accordionP:newOrderForm:TerminiDiConsegnaPanel">  
                                <p:collector unique="false" value="#{term}"  
                                             removeFrom="#{newOrderController.termList}" />  
                            </p:commandButton>  
                        </p:column>  
                    </p:dataTable>
                </p:outputPanel>
            </p:tab>
            <p:tab title="#{bundle.newOrderTabItemTitle}" id="tabItems">
                <p:panel header="Crea Nuovo Freight Item">
                    <p:panelGrid columns="4" id="newFreight" style="vertical-align:text-top">
                        <p:outputLabel for="input_itemID" value="#{bundle.newOrderTabItemID}: " />  
                        <p:inputText id="input_itemID" value="#{newOrderController.currentFrItem.codeId}" required="true" requiredMessage="L'itemID e' obbligatorio"/>

                        <p:outputLabel for="input_itemDesc" value="#{bundle.newOrderTabItemDesc}" />  
                        <p:inputText id="input_itemDesc" value="#{newOrderController.currentFrItem.description}"/>

                        <p:outputLabel for="input_itemType" value="#{bundle.newOrderTabItemType}" />
                        <p:selectOneMenu id="input_itemType" value="#{newOrderController.currentFrItem.ft}">  
                            <f:selectItem itemLabel="Selezionare un tipo" itemValue="" />  
                            <f:selectItem itemLabel="Documenti" itemValue="B" />
                            <f:selectItem itemLabel="Altro Tipo" itemValue="C" />
                        </p:selectOneMenu>

                        <p:outputLabel for="input_itemVolume" value="#{bundle.newOrderTabItemVolume}" />  
                        <p:inputText id="input_itemVolume" value="#{newOrderController.currentFrItem.volume}" converterMessage="must be a number">
                            <f:validateLongRange maximum="15000" />
                        </p:inputText>

                        <p:outputLabel for="input_itemHeight" value="#{bundle.newOrderTabItemHeight}" />  
                        <p:inputText id="input_itemHeight" value="#{newOrderController.currentFrItem.height}" converterMessage="must be a number">
                            <f:validateLongRange maximum="1500" />
                        </p:inputText>

                        <p:outputLabel for="input_itemLenght" value="#{bundle.newOrderTabItemLenght}" />  
                        <p:inputText id="input_itemLenght" value="#{newOrderController.currentFrItem.lenght}" converterMessage="must be a number">
                            <f:validateLongRange maximum="1500" />
                        </p:inputText>

                        <p:outputLabel for="input_itemWidth" value="#{bundle.newOrderTabItemWidth}" />  
                        <p:inputText id="input_itemWidth" value="#{newOrderController.currentFrItem.width}" converterMessage="must be a number">
                            <f:validateLongRange maximum="1500" />
                        </p:inputText>

                        <p:outputLabel for="input_itemWeight" value="#{bundle.newOrderTabItemWeight}" />  
                        <p:inputText type="int" id="input_itemWeight" value="#{newOrderController.currentFrItem.weight}" required="true"
                                     converterMessage="must be a number">
                            <f:validateLongRange maximum="150" />
                        </p:inputText>

                        <p:outputLabel for="input_itemStackable" value="#{bundle.newOrderTabItemStackable}" /> 
                        <p:selectBooleanCheckbox id="input_itemStackable" value="#{newOrderController.currentFrItem.stackable}"/>

                        <p:outputLabel for="input_itemKeepUp" value="#{bundle.newOrderTabItemKeepUp}" /> 
                        <p:selectBooleanCheckbox id="input_itemKeepUp" value="#{newOrderController.currentFrItem.keepUpStanding}"/>

                        <p:commandButton value="Reset" type="reset"/>  
                        <p:commandButton id="btn_add_freight" value="Add" update="freights itemTable"
                                         action="#{newOrderController.addItem()}">
                            <p:collector unique="false" value="#{newOrderController.currentFrItem}"   
                                         addTo="#{newOrderController.itemList}" />  
                        </p:commandButton>
                    </p:panelGrid>         
                </p:panel>
                <p:outputPanel id="freights" autoUpdate="true">
                    <p:dataTable id="itemTable"  value="#{newOrderController.itemList}" var="item">  
                        <p:column>
                            <f:facet name="header">#{bundle.newOrderTabItemID}</f:facet>
                            <h:outputText value="#{item.codeId}"/>         
                        </p:column>
                        <p:column>
                            <f:facet name="header">#{bundle.newOrderTabItemDesc}</f:facet>
                            <h:outputText value="#{item.description}"/>
                        </p:column>
                        <p:column >
                            <f:facet name="header">#{bundle.newOrderTabAttrib}</f:facet>
                            <h:outputText value="type=#{item.ft}, 
                                          dim=#{item.height}x#{item.lenght}x#{item.width},
                                          peso=#{item.weight}, volume=#{item.volume}">

                            </h:outputText>
                        </p:column>
                        <p:column>  
                            <f:facet name="header">  
                                <h:outputText value="Operation" />  
                            </f:facet>  
                            <p:commandButton value="Remove" update=":accordionP:newOrderForm:freights" 
                                             process=":accordionP:newOrderForm:freights">
                                <p:collector unique="false" value="#{item}"  
                                             removeFrom="#{newOrderController.itemList}" />  
                            </p:commandButton> 
                        </p:column>  
                    </p:dataTable>
                </p:outputPanel>
            </p:tab>
            <p:tab title="Confirmation" id="tabConfirm" >
                <p:panel header="confirm">
                    <h:panelGrid columns="2">
                        <h:outputText value="Mittente: " />  
                        <h:outputText value="#{newOrderController.newOrderForm.from.name}"/>
                        <h:outputText value=" - " />
                        <h:outputText value="#{newOrderController.newOrderForm.from.toString()}"/>
                        <h:outputText value="Destinatario: " />  
                        <h:outputText value="#{newOrderController.newOrderForm.to.name}"/>
                        <h:outputText value=" - " />
                        <h:outputText value="#{newOrderController.newOrderForm.to.toString()}"/>
                        <h:outputText value="Termini di consegna:  "/>
                        <p:dataList value="#{newOrderController.newOrderForm.orderData.terminiDiConsegna.entry}" var="term" itemType="disc">
                            <h:outputText value="#{term.key} -> #{term.value}"> 
                            </h:outputText>
                        </p:dataList>
                        <h:outputText value="Items: "/>
                        <p:dataList value="#{newOrderController.itemList}" var="shI" itemType="disc">
                            <h:outputText value="[#{shI.codeId}] #{shI.description}: tipo=#{shI.ft}, 
                                          dim=#{shI.height}x#{shI.lenght}x#{shI.width},
                                          peso=#{shI.weight}, volume=#{shI.volume}">
                            </h:outputText>
                        </p:dataList>
                    </h:panelGrid>
                    <p:commandButton value="Submit"  action="#{newOrderController.addOrder()}" ajax="false"/>
                </p:panel>                            
            </p:tab>
        </p:wizard>
    </h:form>
</html>

